<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Forest Hills CC — Junior Golf Hub</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--dk:#1a472a;--gr:#2d6a3f;--lg:#4a9e6b;--gold:#d4a843;--dkg:#b8922e;--wh:#fff;--off:#f8f6f0;--cr:#f5f0e6;--ch:#2c2c2c;--lt:#e8e5de;--red:#c0392b;--blu:#2980b9;--ven:#008CFF}
body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--off);min-height:100vh;color:var(--ch)}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
header{background:linear-gradient(135deg,var(--dk),var(--gr));color:#fff;position:sticky;top:0;z-index:100;box-shadow:0 2px 12px rgba(0,0,0,.3)}
.hdr-inner{max-width:900px;margin:0 auto;padding:10px 14px}
.hdr-top{display:flex;align-items:center;justify-content:space-between}
.hdr-brand{display:flex;align-items:center;gap:10px}
.hdr-sub{font-size:10px;letter-spacing:2px;opacity:.7;text-transform:uppercase}
.hdr-title{font-size:16px;font-weight:700;color:var(--gold)}
.hdr-sel{background:rgba(255,255,255,.15);color:#fff;border:1px solid rgba(255,255,255,.3);border-radius:6px;padding:5px 8px;font-size:12px}
.hdr-sel option{color:#333}
nav{display:flex;gap:3px;margin-top:8px;overflow-x:auto;padding-bottom:2px;-webkit-overflow-scrolling:touch}
nav button{background:rgba(255,255,255,.1);color:#fff;border:none;border-radius:6px;padding:6px 11px;font-size:12px;font-weight:500;cursor:pointer;white-space:nowrap}
nav button.active{background:var(--gold);color:var(--dk);font-weight:700}
main{max-width:800px;margin:0 auto;padding:14px}
footer{text-align:center;padding:20px 14px;color:#aaa;font-size:11px}
.card{background:var(--wh);border-radius:12px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,.06);margin-bottom:12px}
.card-accent{border-left:4px solid var(--gr)}
.hero{background:linear-gradient(135deg,var(--dk),var(--gr));border-radius:14px;padding:20px;color:#fff;margin-bottom:16px}
.hero h2{font-weight:300;font-size:20px}
.hero p{margin-top:6px;opacity:.8;font-size:13px}
.stat{border-left:4px solid var(--gr);flex:1 1 140px;min-width:130px;padding:14px 16px}
.stat-label{font-size:11px;color:#888;text-transform:uppercase;letter-spacing:1px}
.stat-val{font-size:28px;font-weight:800;margin-top:2px}
.stat-sub{font-size:11px;color:#999;margin-top:2px}
.bar-track{background:var(--lt);border-radius:10px;height:8px;overflow:hidden;width:100%}
.bar-fill{height:100%;border-radius:10px;transition:width .5s}
.badge{padding:3px 10px;border-radius:12px;font-size:11px;font-weight:700;display:inline-block}
.btn{border:none;border-radius:8px;padding:8px 16px;font-size:13px;font-weight:600;cursor:pointer}
.btn-gr{background:var(--gr);color:#fff}
.btn-gold{background:var(--gold);color:var(--dk)}
.btn-ven{background:var(--ven);color:#fff}
.btn-sm{padding:5px 12px;font-size:12px;border-radius:6px}
.score-circle{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;cursor:pointer;border:none;font-weight:600}
.score-minus{border:2px solid var(--lt);background:var(--wh);color:var(--ch)}
.score-plus{background:var(--gr);color:#fff}
.putt-circle{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;cursor:pointer;border:none}
.putt-minus{border:1px solid var(--lt);background:var(--wh);color:var(--ch)}
.putt-plus{background:var(--blu);color:#fff}
.toggle{width:44px;height:24px;border-radius:12px;position:relative;cursor:pointer;transition:.2s}
.toggle-knob{width:20px;height:20px;border-radius:50%;background:#fff;position:absolute;top:2px;transition:.2s;box-shadow:0 1px 3px rgba(0,0,0,.2)}
select,input,textarea{font-family:inherit}
.flex{display:flex}.gap-4{gap:4px}.gap-6{gap:6px}.gap-8{gap:8px}.gap-10{gap:10px}.gap-12{gap:12px}
.wrap{flex-wrap:wrap}.col{flex-direction:column}.between{justify-content:space-between}.center{align-items:center}
.hidden{display:none}
.hole-btn{min-width:40px;padding:7px 12px;font-size:13px;border:none;border-radius:8px;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,.08)}
.hole-btn.active{background:var(--gold);color:var(--dk);font-weight:700}
.hole-btn:not(.active){background:var(--wh);color:var(--ch);font-weight:500}
table{width:100%;border-collapse:collapse}
th,td{padding:6px 4px;text-align:center;font-size:12px}
.live-dot{width:12px;height:12px;border-radius:50%;background:#4caf50;box-shadow:0 0 8px #4caf50;animation:pulse 2s infinite}
.live-border{background:linear-gradient(135deg,rgba(212,168,67,.12),rgba(212,168,67,.04));border:2px solid var(--gold);border-radius:12px;padding:16px;margin-bottom:16px}
</style>
</head>
<body>
<div id="app"></div>
<script>
const C={dk:"#1a472a",gr:"#2d6a3f",lg:"#4a9e6b",gold:"#d4a843",dkg:"#b8922e",wh:"#fff",off:"#f8f6f0",cr:"#f5f0e6",ch:"#2c2c2c",lt:"#e8e5de",red:"#c0392b",blu:"#2980b9",ven:"#008CFF"};

const GROUPS=[
{id:"skills",name:"Skills Challenge",day:"Friday",course:"Practice Facilities",criteria:"Under 70 twice OR under 80 four times",max:null,tees:"N/A",holes:"Stations",tourn:"1-day",rate:25,pars:[]},
{id:"sv4",name:"Short Valley 4",day:"Friday",course:"Valley #1-#4",criteria:"33 or lower three times",max:33,tees:"Black Junior",holes:4,tourn:"1-day",rate:25,pars:[4,3,5,4]},
{id:"lv5",name:"Long Valley 5",day:"Friday",course:"Valley #5-#9",criteria:"35 or lower three times",max:35,tees:"Red",holes:5,tourn:"1-day",rate:25,pars:[4,3,4,5,4]},
{id:"sv9",name:"Short Valley 9",day:"Thursday",course:"Valley Full",criteria:"55 or lower three times",max:55,tees:"Red",holes:9,tourn:"1-day",rate:30,pars:[4,3,5,4,4,3,4,5,4]},
{id:"lv9",name:"Long Valley 9",day:"Thursday",course:"Valley Full",criteria:"Boys: 55 3x / Girls: 60 3x",maxB:55,maxG:60,tees:"White",holes:9,tourn:"1-day",rate:30,pars:[4,3,5,4,4,3,4,5,4]},
{id:"jc9",name:"Junior Champ 9",day:"Friday",course:"Champ #2-#9 or #10-#18",criteria:"Boys: 55 3x / Girls: 60 3x (+5 front)",maxB:55,maxG:60,tees:"Junior",holes:8,tourn:"2-day",rate:35,pars:[4,3,4,4,3,5,4,4]},
{id:"c9",name:"Championship 9",day:"Friday",course:"Champ #1-#9 or #10-#18",criteria:"Boys: 55 3x / Girls: 60 3x",maxB:55,maxG:60,tees:"Boys: White / Girls: Red",holes:9,tourn:"2-day",rate:35,pars:[4,4,3,4,4,3,5,4,4]},
{id:"c18",name:"Championship 18",day:"Friday",course:"Championship Full",criteria:"Top group",max:null,tees:"Boys: Blue/White / Girls: Red",holes:18,tourn:"2-day",rate:35,pars:[4,4,3,4,4,3,5,4,4,4,3,5,4,4,3,4,5,4]}
];

const SCHEDULE=[
{date:"Apr 1",ev:"Online Registration Opens",type:"admin"},
{date:"Apr 28",ev:"Junior Sports Expo / Ice Cream Social",time:"5-7 PM",type:"event"},
{date:"Apr 30",ev:"Registration Closes (Late penalties begin)",type:"admin"},
{date:"May 4",ev:"Pro Shop Evaluation",time:"9-11 AM",type:"eval"},
{date:"May 5",ev:"Parent/Scorer Orientation",time:"5:30-6:30 PM",type:"parent"},
{date:"May 23",ev:"Parent/Scorer Orientation",time:"5:30-6:30 PM",type:"parent"},
{date:"May 30",ev:"Valley 9 Groups — Valley Course",type:"play"},
{date:"May 31",ev:"Skills, 4 & 5 Valley — Championship",type:"play"},
{date:"Jun 4-6",ev:"Camp: Skills, Short Valley 4 & Long Valley 5",type:"camp"},
{date:"Jun 11-14",ev:"Camp: Valley 9, Jr Champ & Champ 9",type:"camp"},
{date:"Jun 14",ev:"Championship 18 Group",type:"play"},
{date:"Jun 20",ev:"Valley 9 Groups — Valley Course",type:"play"},
{date:"Jun 21",ev:"Skills, 4 & 5 Valley — Championship",type:"play"},
{date:"Jun 26",ev:"Junior Member-Guest Tournament",type:"event"},
{date:"Jul 4-5",ev:"No Junior Golf — Happy 4th!",type:"off"},
{date:"Jul 11",ev:"Valley 9 Groups — Valley Course",type:"play"},
{date:"Jul 12",ev:"Skills, 4 & 5 Valley — Championship",type:"play"},
{date:"Jul 13-14",ev:"Parent-Child Tournament",type:"event"},
{date:"Jul 18-19",ev:"Season-Ending Tournament",type:"tournament"},
{date:"Jul 19",ev:"Awards Banquet — 5:45 PM",type:"event"}
];

const JUNIORS=[
{id:1,name:"Ethan M.",age:10,g:"M",group:"sv9",scores:[60,57,55,53,55],priv:[],live:null},
{id:2,name:"Sophia R.",age:12,g:"F",group:"lv9",scores:[62,58,60,57],priv:[],live:{holes:[5,4,6,5,0,0,0,0,0],through:4}},
{id:3,name:"Liam T.",age:8,g:"M",group:"skills",scores:[82,75,71,68],priv:[],live:null},
{id:4,name:"Ava K.",age:14,g:"F",group:"c9",scores:[63,58,61,59,57],priv:[52,55,58],live:null},
{id:5,name:"Noah B.",age:11,g:"M",group:"sv9",scores:[60,57,55,58],priv:[],live:{holes:[4,3,6,4,5,0,0,0,0],through:5}},
{id:6,name:"Olivia W.",age:13,g:"F",group:"jc9",scores:[65,62,59,58],priv:[],live:null},
{id:7,name:"Mason C.",age:15,g:"M",group:"c18",scores:[82,78,80,76],priv:[48,50,49,47,51],live:null},
{id:8,name:"Emma D.",age:9,g:"F",group:"lv5",scores:[40,37,36,35],priv:[],live:null}
];

const SCORERS=[
{id:1,par:"Jennifer M.",jr:"Ethan M.",done:2,req:3,tDone:false,ns:0},
{id:2,par:"David R.",jr:"Sophia R.",done:3,req:3,tDone:true,ns:0},
{id:3,par:"Sarah T.",jr:"Liam T.",done:1,req:3,tDone:false,ns:1},
{id:4,par:"Mike K.",jr:"Ava K.",done:2,req:3,tDone:false,ns:0},
{id:5,par:"Lisa B.",jr:"Noah B.",done:3,req:3,tDone:false,ns:0}
];

const SCORER_REQS=[
{id:1,parent:"Jennifer M.",date:"Jun 27",group:"Short Valley 9",rate:30,status:"open"},
{id:2,parent:"Mike K.",date:"Jul 12",group:"Championship 9",rate:35,status:"filled",scorer:"Pat G."}
];

const SWAPS=[
{id:1,from:"Sarah T.",fromDate:"Jun 27 (Thu)",seeking:"Jul 11 (Thu)",group:"Skills",status:"open"},
{id:2,from:"Lisa B.",fromDate:"Jul 12 (Fri)",seeking:"Jun 28 (Fri)",group:"Short Valley 9",status:"open"}
];

const FINES={s:[75,125,200],e:[100,150,200]};

function getThreshold(g,gender){if(!g)return null;if(g.max)return g.max;return gender==="F"?(g.maxG||null):(g.maxB||null)}
function checkAdv(j){const g=GROUPS.find(x=>x.id===j.group);if(!g)return{ready:false,q:0,need:3,detail:""};if(g.id==="skills"){const u70=j.scores.filter(s=>s<70).length,u80=j.scores.filter(s=>s<80).length;return{ready:u70>=2||u80>=4,q:Math.max(u70,Math.floor(u80/2)),need:2,detail:`${u70} under 70, ${u80} under 80`}}const t=getThreshold(g,j.g);if(!t)return{ready:false,q:0,need:3,detail:"Top group"};const q=j.scores.filter(s=>s<=t).length;return{ready:q>=3,q,need:3,detail:`${q}/3 at ${t} or lower`}}
function checkPriv(j){const t=j.g==="F"?57:50;const q=(j.priv||[]).filter(s=>s<=t).length;return{earned:q>=5,q,need:5,t}}

// State
let state={role:"parent",page:"Dashboard",activeHole:0,holes:[],notes:{},checkedIn:false,scorerReqStep:"list",scorerReqDate:"",scorerReqGroup:"",scorerReqSent:false,schedFilter:"all",selGroup:null};

function initHoles(){
  state.holes=Array.from({length:9},(_,i)=>({num:i+1,par:[4,3,5,4,4,3,4,5,4][i],scores:{"Ethan M.":0,"Noah B.":0,"Sophia R.":0},putts:{"Ethan M.":0,"Noah B.":0,"Sophia R.":0}}));
}
initHoles();

function h(tag,props,...children){
  const el=document.createElement(tag);
  if(props)Object.entries(props).forEach(([k,v])=>{
    if(k==="style"&&typeof v==="object")Object.assign(el.style,v);
    else if(k.startsWith("on"))el.addEventListener(k.slice(2).toLowerCase(),v);
    else if(k==="className")el.className=v;
    else if(k==="innerHTML")el.innerHTML=v;
    else el.setAttribute(k,v);
  });
  children.flat(Infinity).forEach(c=>{if(c!=null&&c!==false)el.appendChild(typeof c==="string"?document.createTextNode(c):c)});
  return el;
}

function bar(cur,tot,color=C.gr){
  return h("div",{className:"bar-track"},h("div",{className:"bar-fill",style:{background:color,width:`${Math.min(cur/tot*100,100)}%`}}));
}

function diamond(size=20,color="#ccc"){
  const s=document.createElementNS("http://www.w3.org/2000/svg","svg");
  s.setAttribute("width",size);s.setAttribute("height",size*1.4);s.setAttribute("viewBox","0 0 32 45");
  s.innerHTML=`<polygon points="16,2 30,22 16,43 2,22" fill="none" stroke="${color}" stroke-width="2"/><line x1="16" y1="2" x2="16" y2="43" stroke="${color}" stroke-width="1" opacity=".5"/><line x1="2" y1="22" x2="30" y2="22" stroke="${color}" stroke-width="1" opacity=".5"/>`;
  return s;
}

function stat(label,val,sub,color=C.gr){
  return h("div",{className:"card stat",style:{borderLeftColor:color}},
    h("div",{className:"stat-label"},label),
    h("div",{className:"stat-val",style:{color}},String(val)),
    sub?h("div",{className:"stat-sub"},sub):null
  );
}

// Pages
const PAGES={
  parent:["Dashboard","Live Tracker","Scores","Request Scorer","Schedule","Groups","Info"],
  scorer:["Dashboard","Live Scoring","Check In","Schedule","Rules Card"],
  admin:["Dashboard","Juniors","Scorers","Requests","Finances","Schedule","Groups","Settings"]
};

function render(){
  const app=document.getElementById("app");
  app.innerHTML="";
  app.appendChild(renderHeader());
  const main=h("main",{});
  main.appendChild(renderPage());
  app.appendChild(main);
  app.appendChild(renderFooter());
}

function renderHeader(){
  const hdr=h("header",{},
    h("div",{className:"hdr-inner"},
      h("div",{className:"hdr-top"},
        h("div",{className:"hdr-brand"},
          diamond(20,"#fff"),
          h("div",{},h("div",{className:"hdr-sub"},"Forest Hills CC"),h("div",{className:"hdr-title"},"Junior Golf"))
        ),
        h("select",{className:"hdr-sel",onChange:e=>{state.role=e.target.value;state.page="Dashboard";render()}},
          ...["parent","scorer","admin"].map(r=>h("option",{value:r,selected:state.role===r?true:undefined},r.charAt(0).toUpperCase()+r.slice(1)))
        )
      ),
      h("nav",{},...PAGES[state.role].map(p=>
        h("button",{className:state.page===p?"active":"",onClick:()=>{state.page=p;render()}},p)
      ))
    )
  );
  return hdr;
}

function renderFooter(){
  return h("footer",{},diamond(14,"#ccc"),h("div",{style:{marginTop:"4px"}},"Forest Hills Country Club • Junior Golf Program"),h("div",{},"Golf Shop: (636) 227-1528"));
}

function renderPage(){
  const r=state.role,p=state.page;
  if(r==="parent"){
    if(p==="Dashboard")return parentDash();
    if(p==="Live Tracker")return liveTracker();
    if(p==="Scores")return scoresView();
    if(p==="Request Scorer")return requestScorer();
    if(p==="Schedule")return scheduleView();
    if(p==="Groups")return groupsView();
    if(p==="Info")return infoView();
  }else if(r==="scorer"){
    if(p==="Dashboard")return scorerDash();
    if(p==="Live Scoring")return liveScoring();
    if(p==="Check In")return checkInView();
    if(p==="Schedule")return scheduleView();
    if(p==="Rules Card")return rulesCard();
  }else{
    if(p==="Dashboard")return adminDash();
    if(p==="Juniors")return adminJuniors();
    if(p==="Scorers")return adminScorers();
    if(p==="Requests")return adminRequests();
    if(p==="Finances")return adminFinances();
    if(p==="Schedule")return scheduleView();
    if(p==="Groups")return groupsView();
    if(p==="Settings")return adminSettings();
  }
  return parentDash();
}

function juniorCard(j){
  const adv=checkAdv(j),g=GROUPS.find(x=>x.id===j.group),t=getThreshold(g,j.g),priv=checkPriv(j);
  const scores=j.scores||[],best=scores.length?Math.min(...scores):null,avg=scores.length?(scores.reduce((a,b)=>a+b,0)/scores.length).toFixed(1):null;
  const trend=scores.length>=2?scores[scores.length-1]-scores[scores.length-2]:0;
  const card=h("div",{className:"card"});
  const top=h("div",{className:"flex between center",style:{marginBottom:"10px"}},
    h("div",{},h("div",{style:{fontSize:"17px",fontWeight:700}},j.name),h("div",{style:{fontSize:"12px",color:"#888"}},"Age "+j.age+" • "+(g?g.name:"")+" • "+(g?g.day:"")+"s")),
    adv.ready?h("span",{className:"badge",style:{background:C.gold,color:C.dk}},"Ready to Advance!"):null
  );
  card.appendChild(top);
  if(t){
    const stats=h("div",{className:"flex gap-8 wrap",style:{marginBottom:"12px"}});
    [{l:"Target",v:t,c:C.dk},{l:"Best",v:best||"–",c:best&&best<=t?C.gr:C.ch},{l:"Average",v:avg||"–",c:C.ch},{l:"Trend",v:trend<0?"↓"+Math.abs(trend):trend>0?"↑"+trend:"—",c:trend<0?C.gr:trend>0?C.red:C.ch}].forEach(s=>{
      stats.appendChild(h("div",{style:{background:C.cr,borderRadius:"8px",padding:"6px 12px",flex:"1 1 70px",textAlign:"center"}},
        h("div",{style:{fontSize:"10px",color:"#888"}},s.l),h("div",{style:{fontSize:"20px",fontWeight:800,color:s.c}},String(s.v))));
    });
    card.appendChild(stats);
  }
  card.appendChild(h("div",{style:{marginBottom:"10px"}},
    h("div",{className:"flex between",style:{fontSize:"12px",marginBottom:"4px"}},h("span",{style:{color:"#666"}},"Advancement"),h("span",{style:{fontWeight:600,color:adv.ready?C.gold:C.gr}},adv.detail)),
    bar(adv.q,adv.need,adv.ready?C.gold:C.gr)
  ));
  const sc=h("div",{className:"flex gap-6 wrap"});
  scores.forEach(s=>{const q=t&&s<=t;sc.appendChild(h("span",{style:{background:q?C.gr+"12":C.cr,border:q?"2px solid "+C.gr:"1px solid "+C.lt,padding:"3px 10px",borderRadius:"6px",fontSize:"13px",fontWeight:700,color:q?C.gr:C.ch}},String(s)))});
  card.appendChild(sc);
  if(["jc9","c9","c18"].includes(j.group)){
    card.appendChild(h("div",{style:{marginTop:"12px",padding:"10px",background:C.cr,borderRadius:"8px"}},
      h("div",{style:{fontSize:"12px",fontWeight:600,marginBottom:"4px"}},"Privilege Card: "+(priv.earned?"Earned":priv.q+"/5 qualifying (≤"+priv.t+")")),
      bar(priv.q,5,priv.earned?C.gold:C.blu)
    ));
  }
  return card;
}

function liveMiniCard(j){
  const g=GROUPS.find(x=>x.id===j.group),t=getThreshold(g,j.g)||55,r=j.live,pars=g?g.pars:[],thru=r.through;
  const scored=r.holes.slice(0,thru),curTot=scored.reduce((a,b)=>a+b,0),parThru=pars.slice(0,thru).reduce((a,b)=>a+b,0);
  const totalH=typeof g?.holes==="number"?g.holes:9,rem=totalH-thru,budget=t-curTot;
  const avgN=rem>0?(budget/rem).toFixed(1):0,onPace=rem>0?curTot<=(t*(thru/totalH)):curTot<=t;
  const proj=rem>0?Math.round(curTot+(curTot/thru)*rem):curTot;
  const card=h("div",{style:{background:C.wh,borderRadius:"10px",padding:"14px",marginTop:"8px"}});
  card.appendChild(h("div",{className:"flex between center"},
    h("div",{},h("div",{style:{fontWeight:700,fontSize:"15px"}},j.name),h("div",{style:{fontSize:"12px",color:"#888"}},(g?g.name:"")+" • Through "+thru+" holes")),
    h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:"28px",fontWeight:800,color:onPace?C.gr:C.red}},String(curTot)),h("div",{style:{fontSize:"11px",color:onPace?C.gr:C.red,fontWeight:600}},(curTot-parThru>=0?"+":"")+(curTot-parThru)+" to par"))
  ));
  const holes=h("div",{className:"flex gap-4",style:{margin:"10px 0"}});
  r.holes.forEach((hv,i)=>{
    const played=i<thru,par=pars[i]||4,diff=hv-par;
    const bg=!played?"transparent":diff<=-1?C.gr+"15":diff>=2?C.red+"15":"transparent";
    const bc=!played?"#ddd":diff<=-1?C.gr:diff>=1?C.red:C.lt;
    holes.appendChild(h("div",{style:{flex:1,textAlign:"center"}},
      h("div",{style:{fontSize:"9px",color:"#aaa"}},String(i+1)),
      h("div",{style:{fontSize:"13px",fontWeight:700,width:"28px",height:"28px",lineHeight:"28px",margin:"0 auto",borderRadius:Math.abs(diff)>=2?"50%":"4px",border:played?"2px solid "+bc:"1px dashed #ddd",background:bg,color:!played?"#ccc":diff<=-1?C.gr:diff>=1?C.red:C.ch}},played?String(hv):"–"),
      h("div",{style:{fontSize:"8px",color:"#bbb"}},String(par))
    ));
  });
  card.appendChild(holes);
  const pace=h("div",{style:{background:(onPace?C.gr:C.red)+"10",borderRadius:"8px",padding:"10px",marginTop:"6px"}});
  pace.appendChild(h("div",{className:"flex between",style:{fontSize:"13px"}},
    h("span",{style:{fontWeight:600,color:onPace?C.gr:C.red}},onPace?"On pace to qualify":"Off pace — needs to rally"),
    h("span",{style:{fontWeight:700}},"Target: "+t)
  ));
  if(rem>0){
    pace.appendChild(h("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"}},
      budget>0?`Needs ${budget} over ${rem} holes (avg ${avgN}/hole) • Projected: ${proj}`:`Already ${Math.abs(budget)} over target with ${rem} holes left`
    ));
  }
  card.appendChild(pace);
  return card;
}

function parentDash(){
  const wrap=h("div",{});
  const mine=JUNIORS.slice(0,2),liveKids=mine.filter(j=>j.live);
  const hero=h("div",{className:"hero"},h("h2",{},"Welcome back!"),h("p",{},liveKids.length>0?liveKids.map(k=>k.name).join(" & ")+" currently on the course":"Next play day is Thursday"));
  wrap.appendChild(hero);
  if(liveKids.length>0){
    const lb=h("div",{className:"live-border"},h("div",{className:"flex center gap-8",style:{marginBottom:"8px"}},h("div",{className:"live-dot"}),h("span",{style:{fontWeight:700,color:C.dk,fontSize:"14px"}},"LIVE ON COURSE")));
    liveKids.forEach(j=>lb.appendChild(liveMiniCard(j)));
    wrap.appendChild(lb);
  }
  mine.forEach(j=>wrap.appendChild(juniorCard(j)));
  const sc=h("div",{className:"card"},h("h3",{style:{margin:"0 0 10px",color:C.dk,fontSize:"15px"}},"Scoring Obligations"),
    h("div",{className:"flex between",style:{fontSize:"13px",marginBottom:"8px"}},h("span",{innerHTML:"Regular season: <strong>2 of 3</strong>"}),h("span",{innerHTML:"Tournament: <strong>Pending</strong>"})),
    bar(2,4),h("div",{style:{marginTop:"8px",fontSize:"12px",color:"#888"},innerHTML:"Next assigned: <strong>Jun 27 (Thu)</strong>"})
  );
  wrap.appendChild(sc);
  const sw=h("div",{className:"card"},h("h3",{style:{margin:"0 0 10px",color:C.dk,fontSize:"15px"}},"Scorer Swap Board"));
  SWAPS.forEach(s=>{
    sw.appendChild(h("div",{className:"flex between center",style:{padding:"10px 0",borderBottom:"1px solid "+C.lt}},
      h("div",{},h("div",{style:{fontSize:"13px",fontWeight:600}},s.from+" wants to swap"),h("div",{style:{fontSize:"12px",color:"#888"}},"Has: "+s.fromDate+" • Wants: "+s.seeking)),
      h("button",{className:"btn btn-gr btn-sm"},"Offer Swap")
    ));
  });
  wrap.appendChild(sw);
  return wrap;
}

function liveTracker(){
  const wrap=h("div",{}),lk=JUNIORS.filter(j=>j.live);
  if(!lk.length)return h("div",{style:{textAlign:"center",padding:"40px"}},h("div",{style:{fontSize:"48px",marginBottom:"12px"}},"⛳"),h("h3",{style:{color:C.dk}},"No Active Rounds"),h("p",{style:{color:"#888",fontSize:"14px"}},"When your child is on the course, their live scores will appear here."));
  wrap.appendChild(h("div",{className:"flex center gap-8"},h("div",{className:"live-dot"}),h("h2",{style:{color:C.dk,fontSize:"20px"}},"Live Round Tracker")));
  lk.forEach(j=>{
    const g=GROUPS.find(x=>x.id===j.group),t=getThreshold(g,j.g)||55,r=j.live,pars=g?g.pars:[],thru=r.through;
    const scored=r.holes.slice(0,thru),curTot=scored.reduce((a,b)=>a+b,0),parThru=pars.slice(0,thru).reduce((a,b)=>a+b,0);
    const totalH=typeof g?.holes==="number"?g.holes:9,rem=totalH-thru,budget=t-curTot;
    const avgN=rem>0?(budget/rem).toFixed(1):0,onPace=rem>0?curTot<=(t*(thru/totalH)):curTot<=t;
    const proj=rem>0?Math.round(curTot+(curTot/thru)*rem):curTot,delta=curTot-parThru;
    const card=h("div",{style:{background:C.wh,borderRadius:"14px",overflow:"hidden",boxShadow:"0 2px 10px rgba(0,0,0,.1)",marginTop:"16px"}});
    card.appendChild(h("div",{style:{background:`linear-gradient(135deg,${C.dk},${C.gr})`,padding:"16px",color:"#fff"}},
      h("div",{className:"flex between center"},
        h("div",{},h("div",{style:{fontSize:"18px",fontWeight:700}},j.name),h("div",{style:{fontSize:"12px",opacity:.8}},(g?g.name:"")+" • "+(g?g.course:""))),
        h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:"36px",fontWeight:800,color:C.gold}},String(curTot)),h("div",{style:{fontSize:"12px",color:delta>=0?"#ff9800":"#8bc34a"}},(delta>=0?"+":"")+delta+" thru "+thru))
      )
    ));
    const body=h("div",{style:{padding:"16px"}});
    const holesRow=h("div",{className:"flex gap-4",style:{marginBottom:"16px"}});
    r.holes.forEach((hv,i)=>{
      const played=i<thru,par=pars[i]||4,diff=hv-par;
      const bg=!played?"transparent":diff<=-1?C.gr+"20":diff>=2?C.red+"25":"transparent";
      const bc=!played?"#ddd":diff<=-1?C.gr:diff>=1?C.red:C.lt;
      holesRow.appendChild(h("div",{style:{flex:1,textAlign:"center"}},
        h("div",{style:{fontSize:"9px",color:"#aaa",marginBottom:"2px"}},"H"+(i+1)),
        h("div",{style:{fontSize:"14px",fontWeight:700,height:"32px",lineHeight:"32px",margin:"0 auto",borderRadius:Math.abs(diff)>=2?"50%":"4px",width:"32px",border:played?"2px solid "+bc:"1px dashed #ddd",background:bg,color:!played?"#ccc":diff<=-1?C.gr:diff>=1?C.red:C.ch}},played?String(hv):"–"),
        h("div",{style:{fontSize:"8px",color:"#bbb",marginTop:"1px"}},"P"+par)
      ));
    });
    body.appendChild(holesRow);
    const paceBox=h("div",{style:{background:(onPace?C.gr:C.red)+"08",border:"2px solid "+(onPace?C.gr:C.red),borderRadius:"10px",padding:"14px"}});
    paceBox.appendChild(h("div",{className:"flex between center",style:{marginBottom:"6px"}},
      h("div",{style:{fontWeight:700,fontSize:"15px",color:onPace?C.gr:C.red}},onPace?"ON PACE":"OFF PACE"),
      h("div",{style:{fontSize:"13px"},innerHTML:`Target: <strong>${t}</strong> | Projected: <strong style="color:${proj<=t?C.gr:C.red}">${proj}</strong>`})
    ));
    if(rem>0)paceBox.appendChild(h("div",{style:{fontSize:"13px",color:C.ch,lineHeight:"1.5"},innerHTML:budget>0?`Has <strong>${budget} strokes</strong> left over <strong>${rem} holes</strong> — needs to average <strong style="color:${avgN<=5?C.gr:C.red}">${avgN}</strong> per hole`:`Already <strong style="color:${C.red}">${Math.abs(budget)} over target</strong> with ${rem} holes left`}));
    const barWrap=h("div",{style:{marginTop:"8px"}});
    barWrap.appendChild(h("div",{className:"flex between",style:{fontSize:"11px",color:"#888",marginBottom:"3px"}},h("span",{},"Progress to target"),h("span",{},curTot+" / "+t)));
    const barOuter=h("div",{style:{background:C.lt,borderRadius:"10px",height:"10px",overflow:"hidden",position:"relative"}});
    barOuter.appendChild(h("div",{style:{background:onPace?C.gr:C.red,height:"100%",width:Math.min(curTot/t*100,100)+"%",borderRadius:"10px"}}));
    barOuter.appendChild(h("div",{style:{position:"absolute",left:(parThru/t*100)+"%",top:0,width:"2px",height:"100%",background:"#999",opacity:.5}}));
    barWrap.appendChild(barOuter);
    barWrap.appendChild(h("div",{className:"flex between",style:{fontSize:"10px",color:"#aaa",marginTop:"2px"}},h("span",{},"0"),h("span",{},"Par ("+parThru+")"),h("span",{},String(t))));
    paceBox.appendChild(barWrap);
    body.appendChild(paceBox);
    card.appendChild(body);
    wrap.appendChild(card);
  });
  return wrap;
}

function scoresView(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Score Tracker"));
  JUNIORS.forEach(j=>{
    const adv=checkAdv(j),g=GROUPS.find(x=>x.id===j.group),t=getThreshold(g,j.g);
    const card=h("div",{className:"card"});
    card.appendChild(h("div",{className:"flex between center",style:{marginBottom:"6px"}},
      h("div",{},h("span",{style:{fontWeight:700}},j.name),h("span",{style:{fontSize:"11px",color:"#888",marginLeft:"8px"}},(g?g.name:"")+(t?" • Target: "+t:""))),
      adv.ready?h("span",{className:"badge",style:{background:C.gold,color:C.dk}},"Advance!"):null
    ));
    const sc=h("div",{className:"flex gap-6 wrap",style:{marginBottom:"6px"}});
    j.scores.forEach(s=>{const q=t&&s<=t;sc.appendChild(h("span",{style:{background:q?C.gr+"12":C.cr,border:q?"2px solid "+C.gr:"1px solid "+C.lt,padding:"3px 9px",borderRadius:"6px",fontSize:"13px",fontWeight:700,color:q?C.gr:C.ch}},String(s)))});
    card.appendChild(sc);
    card.appendChild(h("div",{style:{fontSize:"11px",color:"#888"}},adv.detail));
    card.appendChild(bar(adv.q,adv.need,adv.ready?C.gold:C.gr));
    wrap.appendChild(card);
  });
  return wrap;
}

function requestScorer(){
  const wrap=h("div",{});
  if(state.scorerReqStep==="confirm"&&state.scorerReqSent){
    const g=GROUPS.find(x=>x.name===state.scorerReqGroup);
    wrap.appendChild(h("div",{style:{textAlign:"center",padding:"40px"}},
      h("div",{style:{fontSize:"48px",marginBottom:"12px"}},"✅"),
      h("h3",{style:{color:C.dk}},"Scorer Requested!"),
      h("p",{style:{color:"#666",fontSize:"14px",margin:"10px 0 16px"}},"The Golf Shop will locate a paid scorer."),
      h("div",{style:{background:C.cr,borderRadius:"10px",padding:"16px",display:"inline-block",textAlign:"left"}},
        h("div",{style:{fontSize:"13px"},innerHTML:`<strong>Date:</strong> ${state.scorerReqDate}`}),
        h("div",{style:{fontSize:"13px"},innerHTML:`<strong>Group:</strong> ${state.scorerReqGroup}`}),
        h("div",{style:{fontSize:"13px",marginTop:"8px"},innerHTML:`<strong>Rate:</strong> $${g?g.rate:30}`})
      ),
      h("div",{style:{marginTop:"20px"}},h("button",{className:"btn btn-gr",onClick:()=>{state.scorerReqStep="list";state.scorerReqSent=false;state.scorerReqDate="";state.scorerReqGroup="";render()}},"Done"))
    ));
    return wrap;
  }
  if(state.scorerReqStep==="new"){
    wrap.appendChild(h("button",{style:{background:"none",border:"none",color:C.gr,fontSize:"13px",cursor:"pointer",padding:0,marginBottom:"8px"},onClick:()=>{state.scorerReqStep="list";render()}},"← Back"));
    wrap.appendChild(h("h2",{style:{margin:"0 0 16px",color:C.dk,fontSize:"20px"}},"Request Paid Scorer"));
    const card=h("div",{className:"card"});
    card.appendChild(h("label",{style:{fontSize:"13px",fontWeight:600,display:"block",marginBottom:"6px"}},"Date Needed"));
    const ds=h("select",{style:{width:"100%",padding:"10px 12px",border:"1px solid "+C.lt,borderRadius:"8px",fontSize:"14px",marginBottom:"16px"},onChange:e=>{state.scorerReqDate=e.target.value;render()}});
    ds.appendChild(h("option",{value:""},"Select date..."));
    ["Jun 27 (Thu)","Jun 28 (Fri)","Jul 11 (Thu)","Jul 12 (Fri)","Jul 18 (Thu) - Tournament","Jul 19 (Fri) - Tournament"].forEach(d=>ds.appendChild(h("option",{selected:state.scorerReqDate===d?true:undefined},d)));
    card.appendChild(ds);
    card.appendChild(h("label",{style:{fontSize:"13px",fontWeight:600,display:"block",marginBottom:"6px"}},"Group"));
    const gs=h("select",{style:{width:"100%",padding:"10px 12px",border:"1px solid "+C.lt,borderRadius:"8px",fontSize:"14px",marginBottom:"16px"},onChange:e=>{state.scorerReqGroup=e.target.value;render()}});
    gs.appendChild(h("option",{value:""},"Select group..."));
    GROUPS.forEach(g=>gs.appendChild(h("option",{value:g.name,selected:state.scorerReqGroup===g.name?true:undefined},g.name+" ($"+g.rate+")")));
    card.appendChild(gs);
    if(state.scorerReqDate&&state.scorerReqGroup){
      const gr=GROUPS.find(x=>x.name===state.scorerReqGroup);
      card.appendChild(h("div",{style:{background:C.cr,borderRadius:"10px",padding:"14px",marginBottom:"16px"}},
        h("div",{style:{fontSize:"14px",fontWeight:600,color:C.dk}},"Paid Scorer Rate: $"+(gr?gr.rate:30)),
        h("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"}},"Leave cash at the Golf Shop or pay via Venmo.")
      ));
    }
    const ready=state.scorerReqDate&&state.scorerReqGroup;
    card.appendChild(h("button",{className:"btn",style:{width:"100%",padding:"12px",background:ready?C.gr:C.lt,color:ready?"#fff":"#999",fontSize:"15px",fontWeight:700},onClick:()=>{if(ready){state.scorerReqStep="confirm";state.scorerReqSent=true;render()}}},"Submit Request to Golf Shop"));
    wrap.appendChild(card);
    return wrap;
  }
  wrap.appendChild(h("div",{className:"flex between center",style:{marginBottom:"16px"}},
    h("h2",{style:{margin:0,color:C.dk,fontSize:"20px"}},"Scorer Requests"),
    h("button",{className:"btn btn-gr",onClick:()=>{state.scorerReqStep="new";render()}},"+ Request Scorer")
  ));
  const venmo=h("div",{style:{background:C.ven+"10",border:"1px solid "+C.ven+"40",borderRadius:"10px",padding:"14px",marginBottom:"12px"}});
  venmo.appendChild(h("div",{className:"flex center gap-8",style:{marginBottom:"6px"}},h("div",{style:{background:C.ven,color:"#fff",borderRadius:"6px",padding:"3px 8px",fontSize:"12px",fontWeight:700}},"Venmo"),h("span",{style:{fontSize:"13px",fontWeight:600}},"Pay Your Scorer")));
  venmo.appendChild(h("div",{style:{fontSize:"12px",color:"#666",marginBottom:"10px"}},"Tap below to pay your assigned scorer directly via Venmo."));
  venmo.appendChild(h("a",{href:"https://venmo.com",target:"_blank",style:{display:"inline-flex",alignItems:"center",gap:"6px",background:C.ven,color:"#fff",padding:"8px 20px",borderRadius:"8px",fontSize:"14px",fontWeight:700,textDecoration:"none"}},"Open Venmo to Pay"));
  wrap.appendChild(venmo);
  const reqs=h("div",{className:"card"},h("h3",{style:{margin:"0 0 10px",fontSize:"15px",color:C.dk}},"Your Requests"));
  SCORER_REQS.forEach(r=>{
    reqs.appendChild(h("div",{className:"flex between center",style:{padding:"12px 0",borderBottom:"1px solid "+C.lt}},
      h("div",{},h("div",{style:{fontSize:"14px",fontWeight:600}},r.date+" — "+r.group),h("div",{style:{fontSize:"12px",color:"#888"}},"Rate: $"+r.rate)),
      h("span",{className:"badge",style:{background:r.status==="filled"?C.gr+"15":C.gold+"20",color:r.status==="filled"?C.gr:C.dkg}},r.status==="filled"?"Filled: "+r.scorer:"Pending")
    ));
  });
  wrap.appendChild(reqs);
  const rates=h("div",{className:"card"},h("h3",{style:{margin:"0 0 8px",fontSize:"15px",color:C.dk}},"Paid Scorer Rates"));
  [{g:"Skills & Valley 5-Hole",r:25},{g:"Valley 9-Hole",r:30},{g:"Junior Champ 9",r:35},{g:"Championship 9",r:35},{g:"Championship 18",r:35}].forEach((x,i)=>{
    rates.appendChild(h("div",{className:"flex between",style:{padding:"6px 0",fontSize:"13px",borderBottom:i<4?"1px solid "+C.lt:"none"}},h("span",{},x.g),h("strong",{},"$"+x.r)));
  });
  wrap.appendChild(rates);
  return wrap;
}

function scheduleView(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"2019 Season Schedule"));
  const tc={play:C.gr,camp:C.blu,event:C.gold,admin:"#888",eval:C.dkg,parent:C.lg,tournament:C.red,off:"#bbb"};
  const tl={play:"Play",camp:"Camp",event:"Event",admin:"Admin",eval:"Eval",parent:"Parent",tournament:"Tourney",off:"Off"};
  const filters=h("div",{className:"flex gap-6 wrap",style:{marginBottom:"14px"}});
  ["all","play","camp","event","tournament","parent"].forEach(f=>{
    filters.appendChild(h("button",{style:{background:state.schedFilter===f?C.dk:C.wh,color:state.schedFilter===f?"#fff":C.ch,border:"1px solid "+C.lt,borderRadius:"20px",padding:"5px 12px",fontSize:"11px",cursor:"pointer",textTransform:"capitalize"},onClick:()=>{state.schedFilter=f;render()}},f==="all"?"All":(tl[f]||f)));
  });
  wrap.appendChild(filters);
  const filtered=state.schedFilter==="all"?SCHEDULE:SCHEDULE.filter(s=>s.type===state.schedFilter);
  filtered.forEach(s=>{
    wrap.appendChild(h("div",{style:{background:C.wh,borderRadius:"10px",padding:"12px 14px",boxShadow:"0 1px 3px rgba(0,0,0,.05)",display:"flex",alignItems:"center",gap:"10px",borderLeft:"4px solid "+tc[s.type],marginBottom:"8px"}},
      h("div",{style:{minWidth:"65px",fontSize:"13px",fontWeight:700}},s.date),
      h("div",{style:{flex:1}},h("div",{style:{fontSize:"13px"}},s.ev),s.time?h("div",{style:{fontSize:"11px",color:"#888"}},s.time):null),
      h("span",{style:{background:tc[s.type]+"18",color:tc[s.type],padding:"2px 8px",borderRadius:"10px",fontSize:"10px",fontWeight:600}},tl[s.type])
    ));
  });
  return wrap;
}

function groupsView(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Playing Levels"));
  GROUPS.forEach(g=>{
    const card=h("div",{className:"card card-accent",style:{cursor:"pointer"},onClick:()=>{state.selGroup=state.selGroup===g.id?null:g.id;render()}});
    card.appendChild(h("div",{className:"flex between center"},
      h("div",{},h("div",{style:{fontSize:"15px",fontWeight:700,color:C.dk}},g.name),h("div",{style:{fontSize:"12px",color:"#888"}},g.day+"s • "+g.course)),
      h("span",{style:{transform:state.selGroup===g.id?"rotate(180deg)":"",transition:".2s",fontSize:"16px"}},"▼")
    ));
    if(state.selGroup===g.id){
      card.appendChild(h("div",{style:{marginTop:"10px",paddingTop:"10px",borderTop:"1px solid "+C.lt,fontSize:"13px"}},
        h("div",{style:{marginBottom:"4px"},innerHTML:`<strong>Tees:</strong> ${g.tees}`}),
        h("div",{style:{marginBottom:"4px"},innerHTML:`<strong>Holes:</strong> ${g.holes}`}),
        h("div",{style:{marginBottom:"4px"},innerHTML:`<strong>Advancement:</strong> ${g.criteria}`}),
        h("div",{innerHTML:`<strong>Tournament:</strong> ${g.tourn}`})
      ));
    }
    wrap.appendChild(card);
  });
  return wrap;
}

function infoView(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Program Information"));
  [{t:"Program Fees",c:"Skills through Championship 9: $140 | Championship 18: $80"},
  {t:"Eligibility",c:"Ages 7 (by 7/31) through 19, must be in high school senior year or younger, children of Golfing Members."},
  {t:"Dress Code",c:"No denim. Golf/tennis shoes required. Boys: collared shirts tucked in, golf shorts. Girls: no halter/tank tops or exposed midriffs. Hats bill-forward. Violators sent home."},
  {t:"Scoring Obligations",c:"3 times per season + 1 tournament. No-show fines: $75/$125/$200 (9-hole) or $100/$150/$200 (18-hole)."},
  {t:"Privilege Card",c:"Boys: 5 rounds ≤50 on Championship 9. Girls: 5 rounds ≤57. Must be committee-approved scorer (not parent)."},
  {t:"Future Juniors (4-6)",c:"Pre-junior introduction. Summer sessions Jun-Aug. Limited to 6 per session. Contact Golf Shop."},
  {t:"Contact",c:"Golf Shop: (636) 227-1528 | Head Pro: Marvin Herrod (636) 207-3525 | Chairpersons: Carol Clifford & Chrissie Schultheiss"}
  ].forEach(s=>{
    wrap.appendChild(h("div",{className:"card"},h("div",{style:{fontSize:"14px",fontWeight:700,color:C.dk,marginBottom:"4px"}},s.t),h("div",{style:{fontSize:"13px",lineHeight:"1.5"}},s.c)));
  });
  return wrap;
}

// SCORER VIEWS
function scorerDash(){
  const d=SCORERS[0],wrap=h("div",{});
  wrap.appendChild(h("div",{className:"hero"},h("h2",{},"Scorer Dashboard"),h("p",{},"Next assignment: Jun 27 (Thursday) • Short Valley 9")));
  const stats=h("div",{className:"flex gap-10 wrap",style:{marginBottom:"16px"}});
  stats.appendChild(stat("Completed",d.done+"/"+d.req,"regular season"));
  stats.appendChild(stat("Tournament",d.tDone?"Done":"Pending","1 required",d.tDone?C.gr:C.gold));
  stats.appendChild(stat("No-Shows",d.ns,d.ns>0?"fine assessed":"clean record",d.ns>0?C.red:C.gr));
  wrap.appendChild(stats);
  wrap.appendChild(h("div",{className:"card"},h("h3",{style:{margin:"0 0 8px",color:C.dk,fontSize:"15px"}},"Reminders"),
    h("p",{style:{fontSize:"13px",lineHeight:"1.6",marginBottom:"6px"}},"Arrive 10 min before tee time. Follow club dress code — no denim. Valley Course scorers should walk (no cart preferred)."),
    h("p",{style:{fontSize:"13px",lineHeight:"1.6",margin:0},innerHTML:`Can't make your date? Swap with another parent or call the Golf Shop 24+ hours ahead: <strong>(636) 227-1528</strong>`})
  ));
  return wrap;
}

function liveScoring(){
  const wrap=h("div",{}),players=["Ethan M.","Noah B.","Sophia R."];
  const totalPar=state.holes.reduce((s,x)=>s+x.par,0);
  const tot=p=>state.holes.reduce((s,x)=>s+(x.scores[p]||0),0);
  const totPutts=p=>state.holes.reduce((s,x)=>s+(x.putts[p]||0),0);

  wrap.appendChild(h("div",{style:{background:`linear-gradient(135deg,${C.dk},${C.gr})`,borderRadius:"12px",padding:"14px",color:"#fff",marginBottom:"14px"}},
    h("div",{style:{fontSize:"13px",opacity:.8}},"Now Scoring"),
    h("div",{style:{fontSize:"18px",fontWeight:700}},"Short Valley 9 — Valley Course"),
    h("div",{style:{fontSize:"12px",opacity:.7}},"Thursday • Par "+totalPar)
  ));

  const holeBtns=h("div",{className:"flex gap-4",style:{overflowX:"auto",marginBottom:"14px"}});
  state.holes.forEach((_,i)=>{
    holeBtns.appendChild(h("button",{className:"hole-btn "+(state.activeHole===i?"active":""),onClick:()=>{state.activeHole=i;render()}},String(i+1)));
  });
  wrap.appendChild(holeBtns);

  const ah=state.holes[state.activeHole];
  const card=h("div",{className:"card"});
  card.appendChild(h("div",{className:"flex between center",style:{marginBottom:"14px"}},
    h("div",{style:{fontSize:"20px",fontWeight:800,color:C.dk}},"Hole "+ah.num),
    h("div",{style:{background:C.cr,padding:"4px 12px",borderRadius:"8px",fontWeight:700,color:C.gr}},"Par "+ah.par)
  ));

  players.forEach(p=>{
    const s=ah.scores[p]||0,d=s-ah.par,pt=ah.putts[p]||0;
    const row=h("div",{style:{padding:"10px 0",borderBottom:"1px solid "+C.lt}});
    row.appendChild(h("div",{className:"flex between center"},
      h("div",{},h("div",{style:{fontWeight:600,fontSize:"14px"}},p),h("div",{style:{fontSize:"11px",color:"#888"}},"Total: "+tot(p)+" • Putts: "+totPutts(p))),
      h("div",{className:"flex center gap-10"},
        h("button",{className:"score-circle score-minus",onClick:()=>{ah.scores[p]=Math.max(0,(ah.scores[p]||0)-1);render()}},"−"),
        h("div",{style:{width:"40px",textAlign:"center",fontSize:"26px",fontWeight:800,color:s===0?"#ccc":d<=0&&s>0?C.gr:d>=2?C.red:C.ch}},s||"–"),
        h("button",{className:"score-circle score-plus",onClick:()=>{ah.scores[p]=(ah.scores[p]||0)+1;render()}},"+")
      )
    ));
    row.appendChild(h("div",{className:"flex between center",style:{marginTop:"6px",paddingLeft:"4px"}},
      h("div",{style:{fontSize:"12px",color:C.blu,fontWeight:600}},"Putts"),
      h("div",{className:"flex center gap-8"},
        h("button",{className:"putt-circle putt-minus",onClick:()=>{ah.putts[p]=Math.max(0,(ah.putts[p]||0)-1);render()}},"−"),
        h("div",{style:{width:"30px",textAlign:"center",fontSize:"18px",fontWeight:700,color:pt===0?"#ccc":pt<=1?C.gr:pt>=3?C.red:C.ch}},pt||"–"),
        h("button",{className:"putt-circle putt-plus",onClick:()=>{ah.putts[p]=(ah.putts[p]||0)+1;render()}},"+")
      )
    ));
    card.appendChild(row);
  });

  const noteTA=h("textarea",{placeholder:"Note sportsmanship, pace of play, course care...",style:{width:"100%",marginTop:"4px",padding:"10px",border:"1px solid "+C.lt,borderRadius:"8px",fontSize:"13px",resize:"vertical",minHeight:"50px"},value:state.notes[state.activeHole]||""});
  noteTA.addEventListener("input",e=>{state.notes[state.activeHole]=e.target.value});
  card.appendChild(h("div",{style:{marginTop:"12px"}},h("label",{style:{fontSize:"12px",fontWeight:600,color:"#888"}},"Etiquette / Behavior Notes"),noteTA));
  wrap.appendChild(card);

  // Scorecard table
  const tCard=h("div",{style:{background:C.wh,borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,.06)",marginTop:"14px"}});
  tCard.appendChild(h("div",{style:{background:C.dk,color:"#fff",padding:"8px 14px",fontSize:"13px",fontWeight:600}},"Scorecard"));
  const tbl=h("table",{});
  const thead=h("thead",{});
  const hr1=h("tr",{style:{background:C.cr}});
  hr1.appendChild(h("th",{style:{padding:"6px 10px",textAlign:"left"}},"Hole"));
  state.holes.forEach(x=>hr1.appendChild(h("th",{style:{minWidth:"28px"}},String(x.num))));
  hr1.appendChild(h("th",{style:{fontWeight:700}},"Tot"));
  thead.appendChild(hr1);
  const hr2=h("tr",{style:{background:C.lt}});
  hr2.appendChild(h("td",{style:{padding:"3px 10px",fontSize:"10px",fontWeight:600}},"Par"));
  state.holes.forEach(x=>hr2.appendChild(h("td",{style:{fontSize:"10px"}},String(x.par))));
  hr2.appendChild(h("td",{style:{fontWeight:700,fontSize:"10px"}},String(totalPar)));
  thead.appendChild(hr2);
  tbl.appendChild(thead);
  const tbody=h("tbody",{});
  players.forEach(p=>{
    const sr=h("tr",{});
    sr.appendChild(h("td",{style:{padding:"6px 10px",fontWeight:600,fontSize:"11px",textAlign:"left"}},p.split(" ")[0]));
    state.holes.forEach(x=>{const s=x.scores[p]||0,d=s-x.par;sr.appendChild(h("td",{style:{fontWeight:700,color:s===0?"#ccc":d<=-1?C.gr:d>=2?C.red:C.ch}},s?String(s):"–"))});
    sr.appendChild(h("td",{style:{fontWeight:800,color:C.dk}},String(tot(p))||"–"));
    tbody.appendChild(sr);
    const pr=h("tr",{style:{background:C.blu+"08"}});
    pr.appendChild(h("td",{style:{padding:"3px 10px",fontSize:"9px",color:C.blu,fontWeight:600,textAlign:"left"}},"Putts"));
    state.holes.forEach(x=>{const pt=x.putts[p]||0;pr.appendChild(h("td",{style:{fontSize:"10px",fontWeight:600,color:pt===0?"#ccc":C.blu}},pt?String(pt):"–"))});
    pr.appendChild(h("td",{style:{fontWeight:700,fontSize:"10px",color:C.blu}},String(totPutts(p))||"–"));
    tbody.appendChild(pr);
  });
  tbl.appendChild(tbody);
  tCard.appendChild(h("div",{style:{overflowX:"auto"}},tbl));
  wrap.appendChild(tCard);
  return wrap;
}

function checkInView(){
  const wrap=h("div",{style:{display:"flex",flexDirection:"column",gap:"16px",alignItems:"center",padding:"20px 0"}});
  wrap.appendChild(h("h2",{style:{margin:0,color:C.dk,fontSize:"20px"}},"Scorer Check-In"));
  if(!state.checkedIn){
    wrap.appendChild(h("div",{style:{background:C.wh,borderRadius:"14px",padding:"24px",boxShadow:"0 2px 10px rgba(0,0,0,.1)",textAlign:"center",maxWidth:"400px",width:"100%"}},
      h("div",{style:{fontSize:"13px",color:"#888",marginBottom:"12px"}},"Thursday, Jun 27 • Short Valley 9"),
      h("div",{style:{fontSize:"14px",marginBottom:"20px"}},"Confirm your arrival to avoid no-show fines"),
      h("button",{className:"btn btn-gr",style:{width:"100%",padding:"14px",fontSize:"16px",fontWeight:700},onClick:()=>{state.checkedIn=true;render()}},"Check In Now")
    ));
  }else{
    wrap.appendChild(h("div",{style:{background:C.gr+"10",border:"2px solid "+C.gr,borderRadius:"14px",padding:"24px",textAlign:"center",maxWidth:"400px",width:"100%"}},
      h("div",{style:{fontSize:"48px",marginBottom:"8px"}},"✅"),
      h("div",{style:{fontSize:"18px",fontWeight:700,color:C.gr}},"Checked In!"),
      h("div",{style:{fontSize:"13px",color:"#666",marginTop:"6px"}},"Confirmed at "+new Date().toLocaleTimeString())
    ));
  }
  return wrap;
}

function rulesCard(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 6px",color:C.dk,fontSize:"20px"}},"Quick Rules Reference"),h("div",{style:{fontSize:"13px",color:"#888",marginBottom:"14px"}},"Common situations while scoring"));
  [{t:"Ball Out of Bounds",d:"Stroke and distance penalty. Re-play from original spot with 1 penalty stroke. White stakes mark OB."},
  {t:"Lost Ball",d:"3 minutes to search. If not found, stroke and distance — replay from last spot + 1 penalty."},
  {t:"Water Hazard (Yellow)",d:"1 penalty stroke. Drop behind the hazard keeping entry point between you and hole, or replay."},
  {t:"Lateral Hazard (Red)",d:"1 penalty stroke. Drop within 2 club lengths of where it crossed the margin, no closer to hole."},
  {t:"Unplayable Lie",d:"1 penalty stroke. Three options: replay, drop within 2 club lengths, or drop behind on line from hole."},
  {t:"Bunker Play",d:"Cannot ground club in sand before stroke. Rake the bunker after your shot."},
  {t:"Ball on Green",d:"Mark your ball, repair ball marks, don't step in another player's putting line."},
  {t:"Max Score Rule",d:"Skills through Valley 9: max triple bogey per hole. Championship groups: full stroke play."}
  ].forEach(r=>{
    wrap.appendChild(h("div",{className:"card",style:{marginBottom:"10px"}},h("div",{style:{fontWeight:700,fontSize:"14px",color:C.dk,marginBottom:"4px"}},r.t),h("div",{style:{fontSize:"13px",lineHeight:"1.5"}},r.d)));
  });
  return wrap;
}

// ADMIN VIEWS
function adminDash(){
  const wrap=h("div",{});
  const advR=JUNIORS.filter(j=>checkAdv(j).ready).length,nsI=SCORERS.filter(s=>s.ns>0).length,openR=SCORER_REQS.filter(r=>r.status==="open").length;
  const stats=h("div",{className:"flex gap-10 wrap",style:{marginBottom:"16px"}});
  stats.appendChild(stat("Active Juniors",JUNIORS.length,"across all groups"));
  stats.appendChild(stat("Ready to Advance",advR,"met criteria",C.gold));
  stats.appendChild(stat("Scorer Issues",nsI,"with no-shows",nsI>0?C.red:C.gr));
  stats.appendChild(stat("Open Requests",openR,"need scorers",C.blu));
  wrap.appendChild(stats);

  const dist=h("div",{className:"card"},h("h3",{style:{margin:"0 0 10px",color:C.dk,fontSize:"15px"}},"Group Distribution"));
  GROUPS.forEach(g=>{const cnt=JUNIORS.filter(j=>j.group===g.id).length;
    dist.appendChild(h("div",{className:"flex center gap-10",style:{padding:"6px 0",borderBottom:"1px solid "+C.lt}},
      h("div",{style:{flex:1,fontSize:"13px"}},g.name),h("div",{style:{width:"100px"}},bar(cnt,JUNIORS.length)),h("div",{style:{minWidth:"24px",textAlign:"right",fontWeight:700,color:C.gr,fontSize:"14px"}},String(cnt))
    ));
  });
  wrap.appendChild(dist);

  const adv=h("div",{className:"card"},h("h3",{style:{margin:"0 0 10px",color:C.dk,fontSize:"15px"}},"Advancement Alerts"));
  JUNIORS.filter(j=>checkAdv(j).ready).forEach(j=>{
    const g=GROUPS.find(x=>x.id===j.group),next=GROUPS[GROUPS.indexOf(g)+1];
    adv.appendChild(h("div",{className:"flex between center",style:{padding:"8px 0",borderBottom:"1px solid "+C.lt}},
      h("div",{},h("div",{style:{fontWeight:600,fontSize:"14px"}},j.name),h("div",{style:{fontSize:"11px",color:"#888"}},(g?g.name:"")+" → "+(next?next.name:"Top"))),
      h("button",{className:"btn btn-gold btn-sm"},"Promote")
    ));
  });
  wrap.appendChild(adv);
  return wrap;
}

function adminJuniors(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Junior Golfers"));
  JUNIORS.forEach(j=>{
    const adv=checkAdv(j),g=GROUPS.find(x=>x.id===j.group),t=getThreshold(g,j.g);
    const card=h("div",{className:"card"});
    card.appendChild(h("div",{className:"flex between center"},
      h("div",{},h("span",{style:{fontWeight:700}},j.name),h("span",{style:{fontSize:"11px",color:"#888",marginLeft:"8px"}},"Age "+j.age+" • "+(j.g==="M"?"Boy":"Girl")+" • "+(g?g.name:""))),
      adv.ready?h("span",{className:"badge",style:{background:C.gold,color:C.dk}},"Advance"):null
    ));
    const sc=h("div",{className:"flex gap-4 wrap",style:{marginTop:"6px"}});
    j.scores.forEach(s=>{const q=t&&s<=t;sc.appendChild(h("span",{style:{background:q?C.gr+"12":C.cr,border:q?"1px solid "+C.gr:"1px solid "+C.lt,padding:"2px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:600}},String(s)))});
    card.appendChild(sc);
    card.appendChild(h("div",{style:{fontSize:"11px",color:"#888",marginTop:"4px"}},adv.detail));
    wrap.appendChild(card);
  });
  return wrap;
}

function adminScorers(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Scorer Management"));
  SCORERS.forEach(s=>{
    const card=h("div",{className:"card",style:{borderLeft:"4px solid "+(s.ns>0?C.red:C.gr)}});
    card.appendChild(h("div",{className:"flex between"},
      h("div",{},h("div",{style:{fontWeight:700,fontSize:"14px"}},s.par),h("div",{style:{fontSize:"12px",color:"#888"}},"Junior: "+s.jr)),
      s.ns>0?h("span",{className:"badge",style:{background:C.red+"15",color:C.red}},s.ns+" No-Show — $"+FINES.s[Math.min(s.ns-1,2)]):null
    ));
    card.appendChild(h("div",{className:"flex between",style:{marginTop:"8px",fontSize:"12px"}},h("span",{},"Season: "+s.done+"/"+s.req),h("span",{},"Tournament: "+(s.tDone?"✅":"Pending"))));
    card.appendChild(bar(s.done+(s.tDone?1:0),s.req+1,s.ns>0?C.red:C.gr));
    wrap.appendChild(card);
  });
  return wrap;
}

function adminRequests(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Scorer Requests"));
  SCORER_REQS.forEach(r=>{
    wrap.appendChild(h("div",{className:"card",style:{borderLeft:"4px solid "+(r.status==="filled"?C.gr:C.gold)}},
      h("div",{className:"flex between center"},
        h("div",{},h("div",{style:{fontWeight:700,fontSize:"14px"}},r.parent+" — "+r.date),h("div",{style:{fontSize:"12px",color:"#888"}},r.group+" • $"+r.rate)),
        r.status==="open"?h("button",{className:"btn btn-gr btn-sm"},"Assign Scorer"):h("span",{className:"badge",style:{background:C.gr+"15",color:C.gr}},"Filled: "+r.scorer)
      )
    ));
  });
  return wrap;
}

function adminFinances(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Financial Ledger"));
  const fees=[{i:"Skills–Champ 9 Registration (×6)",a:840,t:"income"},{i:"Champ 18 Registration (×2)",a:160,t:"income"},{i:"Late Registration Penalty (×1)",a:70,t:"income"},{i:"No-Show Fine — Sarah T.",a:75,t:"fine"},{i:"Paid Scorer — Pat G. (Jul 12)",a:-35,t:"expense"}];
  const total=fees.reduce((s,f)=>s+f.a,0);
  const stats=h("div",{className:"flex gap-10 wrap",style:{marginBottom:"16px"}});
  stats.appendChild(stat("Total Revenue","$"+total.toLocaleString(),"",C.gr));
  stats.appendChild(stat("Outstanding Fines","$75","1 unpaid",C.red));
  wrap.appendChild(stats);
  const card=h("div",{className:"card"});
  fees.forEach((f,i)=>{
    card.appendChild(h("div",{className:"flex between",style:{padding:"10px 0",borderBottom:i<fees.length-1?"1px solid "+C.lt:"none"}},
      h("div",{},h("div",{style:{fontSize:"14px"}},f.i),h("div",{style:{fontSize:"11px",color:"#888"}},f.t)),
      h("div",{style:{fontWeight:700,fontSize:"15px",color:f.a<0?C.red:C.gr}},f.a<0?"–$"+Math.abs(f.a):"$"+f.a)
    ));
  });
  wrap.appendChild(card);
  return wrap;
}

function adminSettings(){
  const wrap=h("div",{},h("h2",{style:{margin:"0 0 14px",color:C.dk,fontSize:"20px"}},"Settings"));
  if(!state.toggles)state.toggles={push:true,adv:true,fine:false,remind:true,weather:true};
  [{k:"push",l:"Push Notifications",d:"Advancement and schedule alerts"},{k:"adv",l:"Auto-advancement Alerts",d:"Notify when criteria is met"},{k:"fine",l:"Auto No-Show Fine Emails",d:"Send fine notices automatically"},{k:"remind",l:"Tee Time Reminders",d:"24hr reminder before play days"},{k:"weather",l:"Weather Alerts",d:"Notify on severe weather"}].forEach(s=>{
    const on=state.toggles[s.k];
    wrap.appendChild(h("div",{className:"card",style:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>{state.toggles[s.k]=!state.toggles[s.k];render()}},
      h("div",{},h("div",{style:{fontWeight:600,fontSize:"14px"}},s.l),h("div",{style:{fontSize:"12px",color:"#888"}},s.d)),
      h("div",{className:"toggle",style:{background:on?C.gr:C.lt}},h("div",{className:"toggle-knob",style:{left:on?"22px":"2px"}}))
    ));
  });

  const msg=h("div",{className:"card"},h("h3",{style:{margin:"0 0 10px",fontSize:"15px",color:C.dk}},"Bulk Message"));
  const sel=h("select",{style:{width:"100%",padding:"8px 12px",border:"1px solid "+C.lt,borderRadius:"8px",fontSize:"13px",marginBottom:"10px"}});
  sel.appendChild(h("option",{},"All Parents"));
  GROUPS.forEach(g=>sel.appendChild(h("option",{},g.name+" Parents")));
  sel.appendChild(h("option",{},"All Scorers"));
  msg.appendChild(sel);
  msg.appendChild(h("textarea",{placeholder:"Type your message...",style:{width:"100%",padding:"10px",border:"1px solid "+C.lt,borderRadius:"8px",fontSize:"13px",minHeight:"60px",resize:"vertical"}}));
  msg.appendChild(h("button",{className:"btn btn-gr",style:{marginTop:"8px"}},"Send Message"));
  wrap.appendChild(msg);
  return wrap;
}

// Initial render
render();
</script>
</body>
</html>
